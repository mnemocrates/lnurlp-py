# fail2ban filter for lnurlp-py server
#
# Installation:
# Copy this to /etc/fail2ban/filter.d/lnurlp.conf
#
# This filter catches:
# - Rate limit violations
# - Invalid username attempts
# - Repeated errors from same IP
# - Prohibited content in comments

[Definition]

# Rate limit exceeded
failregex = ^.* - WARNING - \[.*\] Rate limit exceeded for <HOST>$
            ^.* - WARNING - \[.*\] Invalid username request.*from <HOST>$
            ^.* - WARNING - \[.*\] Comment contains prohibited content.*from <HOST>$
            ^.* - WARNING - \[.*\] <HOST> - .*Invalid username.*$
            ^.* - WARNING - \[.*\] <HOST> - .*Missing amount parameter.*$

ignoreregex =

[Init]

# Increase logging verbosity for debugging
# journalmatch = _SYSTEMD_UNIT=lnurlp.service
